---
ai_adapter_avante: "claude"
ai_adapter_chat: "qwen25_coder"
ai_adapter_inline: "{{ ai_adapter_chat }}"
ai_adapter_cmd: "{{ ai_adapter_chat }}"
chatgpt_ai_adapter_chat: "openai"
chatgpt_ai_adapter_inline: "{{ chatgpt_ai_adapter_chat }}"
chatgpt_ai_adapter_cmd: "{{ chatgpt_ai_adapter_chat }}"
anthropic_api_key: "{{ lookup('env', 'ANTHROPIC_API_KEY') | default('') }}"
openai_api_key: "{{ lookup('env', 'OPENAI_API_KEY') | default('') }}"
moonshot_api_key: "{{ lookup('env', 'MOONSHOT_API_KEY') | default('') }}"
ctx_sizes:
  2k: 2048
  4k: 4096
  8k: 8196
  16k: 16384
  32k: 32768
  64k: 65536
  128k: 131072
  256k: 262144
default_distilled_param_count:
  7b: "7b"
  8b: "8b"
  14b: "14b"
  32b: "32b"
  70b: "70"
distilled_param_count: "{{ default_distilled_param_count['7b'] }}"
distilled_ctx_size: "{{ ctx_sizes['4k'] }}"
user_llama_model_info:
  llama3_model_info:
    name: "llama3"
    model_name: "llama3"
    model_tag: "latest"
    model_ctx: "{{ distilled_ctx_size }}"
  deepseek_r1_model_info:
    name: "deepseek_r1"
    model_name: "deepseek-r1"
    model_tag: "{{ distilled_param_count }}"
    model_ctx: "{{ distilled_ctx_size }}"
  qwen25_coder_model_info:
    name: "qwen25_coder"
    model_name: "qwen2.5-coder"
    model_tag: "{{ distilled_param_count }}"
    model_ctx: "{{ distilled_ctx_size }}"
ai_provider: "codex"
ai_adapter_companion: "{{ ai_provider }}"
ai_codecompanion_codex_auth_method: "openai-api-key"
ai_avante_provider: "{{ ai_provider }}"
nvim_ai_codecompanion:
  lazy: |
    {
      "olimorris/codecompanion.nvim",
      event = "VeryLazy",
      dependencies = {
        "nvim-lua/plenary.nvim",
      },
      opts = {
        adapters = {
          acp = {
            codex = function()
              return require("codecompanion.adapters").extend("codex", {
                defaults = {
                  auth_method = "{{ ai_codecompanion_codex_auth_method }}",
                },
                env = {
                  OPENAI_API_KEY = "{{ openai_api_key }}",
                },
              })
            end,
            claude_code = function()
              return require("codecompanion.adapters").extend("claude_code", {
                env = {
                  ANTHROPIC_API_KEY = "{{ anthropic_api_key }}",
                },
              })
            end,
          },
        },
        interactions = {
          chat = {
            adapter = "{{ ai_adapter_companion }}",
          },
        },
      },
    },
    {
      "MeanderingProgrammer/render-markdown.nvim",
      ft = { "markdown", "codecompanion" }
    },
  config: ""
  keymaps: |
    {
      mode = {'n', 't'},
      icon = '',
      { '<C-a>', '<cmd>CodeCompanionChat Toggle<CR>', desc = 'CodeCompanion: Toggle Chat', },
    },
nvim_ai_avante:
  lazy: |
    {
      "yetone/avante.nvim",
      -- if you want to build from source then do `make BUILD_FROM_SOURCE=true`
      -- ⚠️ must add this setting! ! !
      build = vim.fn.has("win32") ~= 0
          and "powershell -ExecutionPolicy Bypass -File Build.ps1 -BuildFromSource false"
          or "make",
      event = "VeryLazy",
      version = false, -- Never set this value to "*"! Never!
      ---@module 'avante'
      ---@type avante.Config
      opts = {
        -- add any opts here
        -- this file can contain specific instructions for your project
        instructions_file = "avante.md",
        -- for example
        provider = "{{ ai_avante_provider }}",
        -- ACP provider configuration for Codex
        acp_providers = {
          ["codex"] = {
            command = "npx",
            args = { "@zed-industries/codex-acp" },
            env = {
              NODE_NO_WARNINGS = "1",
              OPENAI_API_KEY = "{{ openai_api_key }}",
            },
          },
          ["claude-code"] = {
            command = "npx",
            args = { "@zed-industries/claude-code-acp" },
            env = {
              NODE_NO_WARNINGS = "1",
              ANTHROPIC_API_KEY = "{{ anthropic_api_key }}",
            },
          },
        },
        input = {
          provider = "snacks",
          provider_opts = {
            -- Snacks input configuration
            title = "Avante Input",
            icon = "",
            win = {
              position = "float",
              enter = true,
            },
          },
        },
      },
      config = function()
      end,
      dependencies = {
        "nvim-lua/plenary.nvim",
        "MunifTanjim/nui.nvim",
        --- The below dependencies are optional,
        "folke/snacks.nvim", -- for input provider snacks
        "nvim-tree/nvim-web-devicons", -- or echasnovski/mini.icons
        "zbirenbaum/copilot.lua", -- for providers='copilot'
        {
          -- support for image pasting
          "HakonHarnes/img-clip.nvim",
          event = "VeryLazy",
          opts = {
            -- recommended settings
            default = {
              embed_image_as_base64 = false,
              prompt_for_file_name = false,
              drag_and_drop = {
                insert_mode = true,
              },
              -- required for Windows users
              use_absolute_path = true,
            },
          },
        },
        {
          -- Make sure to set this up properly if you have lazy=true
          'MeanderingProgrammer/render-markdown.nvim',
          opts = {
            file_types = { "markdown", "Avante" },
          },
          ft = { "markdown", "Avante" },
        },
      },
    },
  config: ""
  keymaps: |
    {
      mode = {'n', 't'},
      icon = '',
      { '<C-a>', '<cmd>AvanteToggle<CR>', desc = 'Avante: Toggle Chat', },
    },
nvim_ai_agentic:
  lazy: |
    {
      "carlos-algms/agentic.nvim",
      opts = {
        -- Available by default: "claude-acp" | "gemini-acp" | "codex-acp" | "opencode-acp" | "cursor-acp" | "auggie-acp"
        provider = "{{ ai_provider }}-acp",
        acp_providers = {
          ["codex-acp"] = {
            default_mode = "read-only",
          },
        },
      },
      -- these are just suggested keymaps; customize as desired
      keys = {
        {
          "<C-a>",
          function() require("agentic").toggle() end,
          mode = { "n", "v", "i" },
          desc = "Toggle Agentic Chat"
        },
        {
          "<C-'>",
          function() require("agentic").new_session() end,
          mode = { "n", "v", "i" },
          desc = "New Agentic Session"
        },
        -- {
        --   "<C-'>",
        --   function() require("agentic").add_selection_or_file_to_context() end,
        --   mode = { "n", "v" },
        --   desc = "Add file or selection to Agentic to Context"
        -- },
        -- {
        --   "<C-,>",
        --   function() require("agentic").new_session() end,
        --   mode = { "n", "v", "i" },
        --   desc = "New Agentic Session"
        -- },
        -- {
        --   "<A-i>r", -- ai Restore
        --   function()
        --       require("agentic").restore_session()
        --   end,
        --   desc = "Agentic Restore session",
        --   silent = true,
        --   mode = { "n", "v", "i" },
        -- },
      },
    },
  config: ""
  keymaps: ""
nvim_ai_codex:
  lazy: |
    {
      'kkrampis/codex.nvim',
      lazy = true,
      cmd = { 'Codex', 'CodexToggle' }, -- Optional: Load only on command execution
      keys = {
        {
          "<C-'>", -- Change this to your preferred keybinding
          function() require('codex').toggle() end,
          desc = 'Toggle Codex popup or side-panel',
          mode = { 'n', 'x' }
        },
      },
      opts = {
        keymaps     = {
          toggle = "<C-'>", -- Keybind to toggle Codex window (Disabled by default, watch out for conflicts)
          quit = "<C-q>", -- Keybind to close the Codex window (default: Ctrl + q)
        },         -- Disable internal default keymap (<leader>cc -> :CodexToggle)
        border      = 'rounded',  -- Options: 'single', 'double', or 'rounded'
        width       = 0.8,        -- Width of the floating window (0.0 to 1.0)
        height      = 0.8,        -- Height of the floating window (0.0 to 1.0)
        model       = nil,        -- Optional: pass a string to use a specific model (e.g., 'o3-mini')
        autoinstall = false,       -- Automatically install the Codex CLI if not found
        panel       = false,      -- Open Codex in a side-panel (vertical split) instead of floating window
        use_buffer  = false,      -- Capture Codex stdout into a normal buffer instead of a terminal buffer
      },
    },
  config: ""
  keymaps: ""
nvim_ai_claude:
  lazy: |
    {
      "coder/claudecode.nvim",
      dependencies = { "folke/snacks.nvim" },
      keys = {
        { "<C-a>", "<cmd>ClaudeCodeFocus<cr>", desc = "Claude Code: Focus", mode = { "n", "x" } },
        -- { "<C-'>", "<cmd>ClaudeCodeAdd %<cr>", desc = "Claude Code: Add current buffer", mode = { "n", "x" } },
        -- { "<C-'>", "<cmd>ClaudeCodeSend<cr>", desc = "Claude Code: Send to Claude", mode = "v" },
      },
      opts = {
        terminal = {
          ---@module "snacks"
          ---@type snacks.win.Config|{}
          snacks_win_opts = {
            position = "float",
            width = 0.9,
            height = 0.9,
            keys = {
              claude_hide = {
                "<C-a>",
                function(self)
                  self:hide()
                end,
                mode = "t",
                desc = "Hide",
              },
            },
          },
        },
      },
    },
  config: ""
  keymaps: ""
nvim_ai_opencode:
  lazy: |
    {
      "NickvanDyke/opencode.nvim",
      version = "*", -- Latest stable release
      dependencies = {
        {
          -- `snacks.nvim` integration is recommended, but optional
          ---@module "snacks" <- Loads `snacks.nvim` types for configuration intellisense
          "folke/snacks.nvim",
          optional = true,
          opts = {
            input = {}, -- Enhances `ask()`
            picker = { -- Enhances `select()`
              actions = {
                opencode_send = function(...) return require("opencode").snacks_picker_send(...) end,
              },
              win = {
                input = {
                  keys = {
                    ["<a-a>"] = { "opencode_send", mode = { "n", "i" } },
                  },
                },
              },
            },
            terminal = {}, -- Enables the `snacks` provider
          },
        },
      },
      config = function()
        vim.g.opencode_opts = {
          provider = {
            snacks = {
              win = {
                position = "float",
                enter = true,
                on_buf = function(win)
                  vim.keymap.set("t", "<C-u>", function() require("opencode").command("session.half.page.up") end, { desc = "Messages half page up", buffer = win.buf })
                  vim.keymap.set("t", "<C-d>", function() require("opencode").command("session.half.page.down") end, { desc = "Messages half page down", buffer = win.buf })
                  vim.keymap.set("n", "gg", function() require("opencode").command("session.first") end, { desc = "Scroll to Beginning", buffer = win.buf })
                  vim.keymap.set("n", "G", function() require("opencode").command("session.last") end, { desc = "Scroll to End", buffer = win.buf })
                  vim.keymap.set({"n", "t"}, "<esc>", function() require("opencode").command("session.interrupt") end, { desc = "Interrupt", buffer = win.buf })
                end,
              },
            },
          },
        }

        -- Required for `vim.g.opencode_opts.auto_reload`
        vim.o.autoread = true

        -- Recommended/example keymaps
        vim.keymap.set({ "n", "x" }, "<leader>Ca", function() require("opencode").ask("@this: ", { submit = true }) end, { desc = "Ask about this" })
        vim.keymap.set({ "n", "x" }, "<leader>Cb", function() require("opencode").ask("@buffer: ", { submit = true }) end, { desc = "Ask about buffer" })
        vim.keymap.set({ "n", "x" }, "<leader>Cs", function() require("opencode").select() end, { desc = "Select prompt" })
        vim.keymap.set({ "n", "x" }, "<leader>C+", function() require("opencode").prompt("@this") end, { desc = "Add this" })
        vim.keymap.set("n", "<leader>Cc", function() require("opencode").command() end, { desc = "Select command" })
        vim.keymap.set("n", "<leader>Cn", function() require("opencode").command("session.new") end, { desc = "New session" })
        vim.keymap.set("n", "<leader>Ci", function() require("opencode").command("session.interrupt") end, { desc = "Interrupt session" })
        vim.keymap.set("n", "<leader>CA", function() require("opencode").command("agent.cycle") end, { desc = "Cycle selected agent" })
        -- vim.keymap.set("n", "<leader>Co", function() require("opencode").toggle() end, { desc = "Toggle Floating Opencode" })
        vim.keymap.set({ "n", "t" }, "<C-.>", function() require("opencode").toggle() end, { desc = "Opencode: Toggle" })
      end,
    },
  config: ""
  keymaps: ""
nvim_ai_opencode_sudotee:
  lazy: |
    {
      "sudo-tee/opencode.nvim",
      config = function()
        require("opencode").setup({
          preferred_picker = 'snacks', -- 'telescope', 'fzf', 'mini.pick', 'snacks', 'select', if nil, it will use the best available picker. Note mini.pick does not support multiple selections
          preferred_completion = 'nvim-cmp', -- 'blink', 'nvim-cmp','vim_complete' if nil, it will use the best available completion
          default_mode = 'todo', -- 'build' or 'plan' or any custom configured. @see [OpenCode Agents](https://opencode.ai/docs/modes/)
          keymap = {
            input_window = {
              ['<C-t>'] = { 'cycle_variant', mode = { 'n', 'i' } }, -- Cycle through available model variants
            },
            output_window = {
              ['<C-t>'] = { 'cycle_variant', mode = { 'n' } }, -- Cycle through available model variants
            },
          },
        })
        local Terminal  = require('toggleterm.terminal').Terminal
        local sidecar = Terminal:new({
          cmd = '{{ sidecar_exe }}',
          shell = '{{ command_shell }}',
          hidden = true,
          start_in_insert = true,
        })
        function sidecar_terminal_runner()
          sidecar:toggle()
        end
      end,
      dependencies = {
        "nvim-lua/plenary.nvim",
        {
          "MeanderingProgrammer/render-markdown.nvim",
          opts = {
            anti_conceal = { enabled = false },
            file_types = { 'markdown', 'opencode_output' },
          },
          ft = { 'markdown', 'Avante', 'copilot-chat', 'opencode_output' },
        },
        'hrsh7th/nvim-cmp',
        'folke/snacks.nvim',
      },
    },
  config: ""
  keymaps: |
    {
      mode = {'n', 't'},
      icon = '',
      { '<C-/>', '<cmd>lua sidecar_terminal_runner()<CR>', desc = 'ToggleTerm: Sidecar', },
    },
