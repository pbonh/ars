# Brewfile generated by Ansible (homebrew role)
# Sources: homebrew_taps, dev_packages.*.brew, flatpak_apps_bundle_map (casks/formulae), and homebrew_brewfile_extra_* overrides.

{% set tap_lists = homebrew_taps | default({}) | dict2items | selectattr('value.brew_tap', 'defined') | map(attribute='value.brew_tap') | list %}
{% set taps = (tap_lists | select('defined') | list | flatten | list) + (homebrew_brewfile_extra_taps | default([])) %}
{% set formula_lists = dev_packages | default({}) | dict2items | selectattr('value.brew', 'defined') | map(attribute='value.brew') | list %}
{% set formulae = (formula_lists | flatten | list) + (homebrew_formula_packages_extra | default([])) + (homebrew_brewfile_extra_formulae | default([])) %}
{% set casks = (homebrew_cask_packages | default([])) + (homebrew_brewfile_extra_casks | default([])) %}
{% set flatpaks = homebrew_flatpak_packages | default([]) %}

{% for tap in taps | unique | sort %}
tap "{{ tap }}"
{% endfor %}
{% for formula in formulae | unique | sort %}
brew "{{ formula }}"
{% endfor %}
{% for cask in casks | unique | sort %}
cask "{{ cask }}"
{% endfor %}
{% for flatpak in flatpaks | unique(attribute='flatpak') | sort(attribute='flatpak') %}
flatpak "{{ flatpak.flatpak }}"{{ ', remote: "' ~ flatpak.remote ~ '"' if flatpak.remote is defined else '' }}{{ ', url: "' ~ flatpak.url ~ '"' if flatpak.url is defined else '' }}
{% endfor %}
