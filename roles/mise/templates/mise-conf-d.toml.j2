{# SPDX-License-Identifier: MIT-0 #}
{%- set _item_vars = item.vars | default({}) -%}
{%- set mise_env_effective = _item_vars.get('mise_env', mise_env_effective) -%}
{%- set mise_tools_effective = _item_vars.get('mise_tools', mise_tools_effective) -%}
{%- set mise_tasks_effective = _item_vars.get('mise_tasks', mise_tasks_effective) -%}
{%- set mise_settings_effective = _item_vars.get('mise_settings', mise_settings_effective) -%}
{%- set mise_plugins_effective = _item_vars.get('mise_plugins', mise_plugins_effective) -%}
{%- set mise_tool_alias_effective = _item_vars.get('mise_tool_alias', mise_tool_alias_effective) -%}
{%- set mise_shell_alias_effective = _item_vars.get('mise_shell_alias', mise_shell_alias_effective) -%}
{%- set mise_min_version_hard_effective = _item_vars.get('mise_min_version_hard', mise_min_version_hard_effective) -%}
{%- set mise_min_version_soft_effective = _item_vars.get('mise_min_version_soft', mise_min_version_soft_effective) -%}
{%- set mise_experimental_monorepo_root_effective = _item_vars.get('mise_experimental_monorepo_root', mise_experimental_monorepo_root_effective) -%}
{%- set mise_config_raw_effective = _item_vars.get('mise_config_raw', mise_config_raw_effective) -%}
{%- set _schema = _item_vars.get('schema_url', item.schema_url | default(mise_schema_url_effective)) -%}
{%- if _schema %}
# yaml-language-server: $schema={{ _schema }}

{% endif %}
{% if mise_env_effective | length > 0 %}
[env]
{% for k, v in mise_env_effective.items() %}
{{ k }} = {{ v | tojson }}
{% endfor %}

{% endif %}
{% if mise_tools_effective | length > 0 %}
[tools]
{% for k, v in mise_tools_effective.items() %}
{{ k }} = {{ v | tojson }}
{% endfor %}

{% endif %}
{% if mise_tasks_effective | length > 0 %}
[tasks]
{% for k, v in mise_tasks_effective.items() %}
[tasks.{{ k }}]
{% for tk, tv in v.items() %}
{{ tk }} = {{ tv | tojson }}
{% endfor %}

{% endfor %}

{% endif %}
{% if mise_settings_effective | length > 0 %}
[settings]
{% for k, v in mise_settings_effective.items() %}
{{ k }} = {{ v | tojson }}
{% endfor %}

{% endif %}
{% if mise_plugins_effective | length > 0 %}
[plugins]
{% for k, v in mise_plugins_effective.items() %}
{{ k }} = {{ v | tojson }}
{% endfor %}

{% endif %}
{% if mise_tool_alias_effective | length > 0 %}
[tool_alias]
{% for tool, aliases in mise_tool_alias_effective.items() %}
[tool_alias.{{ tool }}.versions]
{% for name, val in aliases.get('versions', {}).items() %}
{{ name }} = {{ val | tojson }}
{% endfor %}

{% endfor %}

{% endif %}
{% if mise_shell_alias_effective | length > 0 %}
[shell_alias]
{% for k, v in mise_shell_alias_effective.items() %}
{{ k }} = {{ v | tojson }}
{% endfor %}

{% endif %}
{% if mise_config_raw_effective | length > 0 %}
{{ mise_config_raw_effective }}
{% endif %}
